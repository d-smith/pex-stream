# notes - kda set up

Schema is ROWTIME TIMESTAMP, symbol varchar(32), price DOUBLE, confidence DOUBLE, plus the kinesis cols

Baseline sample query

```
CREATE OR REPLACE STREAM "DESTINATION_SQL_STREAM" ("symbol" VARCHAR(32), "symbol_count" INTEGER);
CREATE OR REPLACE  PUMP "STREAM_PUMP" AS INSERT INTO "DESTINATION_SQL_STREAM"
SELECT STREAM "symbol", COUNT(*) AS "symbol_count"
FROM "SOURCE_SQL_STREAM_001"
GROUP BY "symbol", FLOOR(("SOURCE_SQL_STREAM_001".ROWTIME - TIMESTAMP '1970-01-01 00:00:00') SECOND / 10 TO SECOND);
```

What about

CREATE OR REPLACE STREAM "DESTINATION_SQL_STREAM" ("symbol" VARCHAR(32), "price" DOUBLE, "confidence" DOUBLE);
CREATE OR REPLACE  PUMP "STREAM_PUMP" AS INSERT INTO "DESTINATION_SQL_STREAM"
SELECT STREAM "symbol",
LAST_VALUE("price") OVER W1 AS "price",
LAST_VALUE("confidence") OVER W1 AS "confidence"
FROM "SOURCE_SQL_STREAM_001"
WINDOW W1 AS (
    PARTITION BY "symbol"
    RANGE INTERVAL '10' SECOND PRECEDING
)

Yes!